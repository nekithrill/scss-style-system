@use 'sass:meta';
@use 'sass:map';

/// Validate theme structure against schema
/// @param {Map} $theme - Theme to validate
/// @param {Map} $schema - Schema structure
/// @param {String|Null} $path - Current path for error messages

@mixin validate-theme($theme, $schema, $path: null) {
	@each $key, $value in $schema {
		$current-path: $key;
		@if $path {
			$current-path: '#{$path}.#{$key}';
		}

		@if not map.has-key($theme, $key) {
			@error "Missing required key: #{$current-path}";
		}

		@if meta.type-of($value) ==
			'map' and
			meta.type-of(map.get($theme, $key)) ==
			'map'
		{
			@include validate-theme(map.get($theme, $key), $value, $current-path);
		}
	}
}
